<!doctype html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Member Statistics</title>
<meta name="description" content="这是一个 会员统计 页面">
<meta name="keywords" content="user">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="icon" type="image/png" href="assets/i/favicon.png">
<link rel="apple-touch-icon-precomposed"
	href="assets/i/app-icon72x72@2x.png">
<meta name="apple-mobile-web-app-title" content="Amaze UI" />
<link rel="stylesheet" href="assets/css/amazeui.min.css" />
<link rel="stylesheet" href="assets/css/admin.css">
<script src="assets/js/jquery-3.3.1.min.js"></script>

<script src="assets/js/amazeui.min.js"></script>

<script src="assets/js/app.js"></script>

<script src="assets/js/echarts.js"></script>
<script>
function  showView(){
	getInfo();
}
function getInfo(){
	var thisURL=decodeURI(window.location.href);
	var name =thisURL.split('~')[1];
	var ID=thisURL.split('~')[2];

  }
</script>

</head>

<body onload="showView()" style="height: 100%; margin: 0">


	<header class="am-topbar am-topbar-inverse admin-header">
		<div class="am-topbar-brand">
			<strong>Yummy</strong> <small>经理</small>
		</div>

		<button
			class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only"
			data-am-collapse="{target: '#topbar-collapse'}">
			<span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span>
		</button>

		<div class="am-collapse am-topbar-collapse" id="topbar-collapse">

			<ul
				class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list">
				<li><a href="javascript:;"><span class="am-icon-envelope-o"></span>
						收件箱 <span class="am-badge am-badge-warning">5</span></a></li>
				<li class="am-dropdown" data-am-dropdown><a
					class="am-dropdown-toggle" data-am-dropdown-toggle
					href="javascript:;"> <span class="am-icon-users"></span> 管理员 <span
						class="am-icon-caret-down"></span>
				</a>
					<ul class="am-dropdown-content">
						<li><a href="#"><span class="am-icon-user"></span> 资料</a></li>
						<li><a href="#"><span class="am-icon-cog"></span> 设置</a></li>
						<li><a href="#"><span class="am-icon-power-off"></span>
								退出</a></li>
					</ul></li>
				<li class="am-hide-sm-only"><a href="javascript:;"
					id="admin-fullscreen"><span class="am-icon-arrows-alt"></span>
						<span class="admin-fullText">开启全屏</span></a></li>
			</ul>
		</div>
	</header>

	<div class="am-cf admin-main">
		<!-- sidebar start -->
		<div class="admin-sidebar am-offcanvas" id="admin-offcanvas">
			<div class="am-offcanvas-bar admin-offcanvas-bar">
				<ul class="am-list admin-sidebar-list">
					<li><a onclick="approve()"><span class="am-icon-home"></span>
							审批中心</a></li>
					<li class="memberInfo-parent"><a class="am-cf"
						data-am-collapse="{target: '#collapse-nav'}"><span
							class="am-icon-file"></span> 统计 <span
							class="am-icon-angle-right am-fr am-margin-right"></span></a>
						<ul class="am-list am-collapse admin-sidebar-sub am-in"
							id="collapse-nav">
							<li><a onclick="restaurantStatistics()"> 餐厅统计</a></li>

							<li><a onclick="memberStatistics()"> 会员统计</a></li>
							<li><a onclick="financeStatistics()"> 财务情况</a></li>
						</ul></li>
					<li class="order-parent"><a class="am-cf"
						data-am-collapse="{target: '#collapse-nav'}"><span
							class="am-icon-file"></span> 结算 <span
							class="am-icon-angle-right am-fr am-margin-right"></span></a>
						<ul class="am-list am-collapse admin-sidebar-sub am-in"
							id="collapse-nav">
							<li><a onclick="balance()" class="am-cf">结算财务</a></li>

						</ul></li>
					<li><a href="Login.html"><span class="am-icon-sign-out"></span>
							退出</a></li>
				</ul>

				<div class="am-panel am-panel-default admin-sidebar-panel">
					<div class="am-panel-bd">
						<p>
							<span class="am-icon-bookmark"></span> 公告
						</p>
						<p>吃得开心！</p>
					</div>
				</div>

				<div class="am-panel am-panel-default admin-sidebar-panel">
					<div class="am-panel-bd">
						<p>
							<span class="am-icon-tag"></span> wiki
						</p>
						<p>Welcome to Yummy!</p>
					</div>
				</div>
			</div>
		</div>

		<!-- content start -->
		<div class="admin-content">
			<div class="admin-content-body">
				<div class="am-cf am-padding am-padding-bottom-0">
					<div class="am-fl am-cf">
						<strong class="am-text-primary am-text-lg">会员统计</strong> / <small>Member
							Statictics</small>
					</div>
				</div>

				<div class="am-g">
					<div class="am-u-sm-12 am-u-md-6">
						<div class="am-btn-toolbar">
							<div class="content-page">
								<!-- Start content -->
								<div class="content">
									<div class="am-g">
										<div class="am-u-sm-12 am-u-md-4">
											<div class="am-form-group">
												开始日期: <input type="date" name="bday" id="startdate">
											</div>
										</div>

										<div class="am-u-sm-12 am-u-md-4">
											<div class="am-input-group am-input-group-sm">
												结束日期: <input type="date" name="bday" id="enddate">
											</div>
										</div>

										<div class="am-u-sm-12 am-u-md-4">
											<div class="am-input-group am-input-group-sm">
												间隔: <input type="text" name="bday" id="gap">
												<button onclick="getData()">提交</button>
											</div>
										</div>


										<div class="am-g">
											<div class="am-u-md-12">
												
												<div class="card-box">
													<div id="Stack"
														style="width: 100%; height: 400px; border: 1px solid #ccc;">
													</div>
												</div>
											</div>


										</div>

									</div>
								</div>

							</div>
						</div>
					</div>
				</div>
				<div class="am-g">
					<div class="am-u-sm-12 am-u-md-4 am-u-md-push-8"></div>

					<div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4">


						<div id="container" style="height: 300px"></div>

					</div>
				</div>
			</div>
		</div>

		<footer class="admin-content-footer">
			<hr>
			<p class="am-padding-left">祝您吃得开心！</p>
		</footer>

	</div>
	<!-- content end -->


	<a href="#"
		class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu"
		data-am-offcanvas="{target: '#admin-offcanvas'}"></a>

	<footer>
		<hr>
		<p class="am-padding-left">祝您吃得开心！</p>
	</footer>


	<script type="text/javascript"> 
	function approve(){
		var thisURL=decodeURI(window.location.href);
		var name =thisURL.split('~')[1];
		var ID=thisURL.split('~')[2];
		var url=encodeURI("Manager.html?"+"~"+name+"~"+ID);
		window.location.href=url;
	}
	function restaurantStatistics(){
		var thisURL=decodeURI(window.location.href);
		var name =thisURL.split('~')[1];
		var ID=thisURL.split('~')[2];
		var url=encodeURI("RestaurantStatistics.html?"+"~"+name+"~"+ID);
		window.location.href=url;
	}
	function memberStatistics(){
		var thisURL=decodeURI(window.location.href);
		var name =thisURL.split('~')[1];
		var ID=thisURL.split('~')[2];
		var url=encodeURI("MemberStatistics.html?"+"~"+name+"~"+ID);
		window.location.href=url;
	}
	function financeStatistics(){
		var thisURL=decodeURI(window.location.href);
		var name =thisURL.split('~')[1];
		var ID=thisURL.split('~')[2];
		var url=encodeURI("FinanceStatistics.html?"+"~"+name+"~"+ID);
		window.location.href=url;
	}
	function balance(){
		var thisURL=decodeURI(window.location.href);
		var name =thisURL.split('~')[1];
		var ID=thisURL.split('~')[2];
		var url=encodeURI("Balance.html?"+"~"+name+"~"+ID);
		window.location.href=url;
	}
	
	function getData(){
		var startdateStr = document.getElementById("startdate").value;
		var startStr = startdateStr.split("-");
		var startStrings = "";
		for(var i=0;i<startStr.length;i++){
			startStrings=startStrings+startStr[i];
		}
		var startdate = parseInt(startStrings);
		
		var enddateStr = document.getElementById("enddate").value;
		var endStr = enddateStr.split("-");
		var endStrings = "";
		for(var i=0;i<endStr.length;i++){
			endStrings=endStrings+endStr[i];
		}
		var enddate = parseInt(endStrings);
		
		var gap = document.getElementById("gap").value
		$.ajax({
			type: "POST", //方法类型
			dataType: "json", //数据类型
			url: "GetRegistMemberNumDivByDefServlet", //url
            data:{"startdate":startdate,"enddate":enddate,"gap":gap},
			
			success: function(result){
				var day = [];
				var num = [];
				var info={};
				for(var i=0;i<result.length;i++){
						var begin=addDate(startdateStr,i*gap);
						begin = begin.slice(5);
						var end=addDate(startdateStr,i*gap+2);
						end = end.slice(5);
						var interval=begin+"~"+end;
						info[interval]=result[i];
						day.push(interval);
						num.push(result[i]);
				}
				
				//坐标轴刻度与标签对齐
				(function(){
					
				var columnar1 = echarts.init(document.getElementById("Stack"));

				option = {
					
					title: {
						text: "会员注册统计柱状图",
						x:'left'
					},
					
				    color: ['#3398DB'],
				    tooltip : {
				        trigger: 'axis',
				        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
				            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
				        }
				    },
				    toolbox: {
				        feature: {
				            saveAsImage: {}
				        }
				    },
				    grid: {
				        left: '3%',
				        right: '4%',
				        bottom: '3%',
				        containLabel: true
				    },
				    xAxis : [
				        {
				            type : 'category',
				            data : day,
				            axisTick: {
				                alignWithLabel: true
				            }
				        }
				    ],
				    yAxis : [
				        {
				            type : 'value'
				        }
				    ],
				    series : [
				        {
				            name:'会员注册数量',
				            type:'bar',
				            barWidth: '60%',
				            data:num,
				        }
				    ]
				};

				columnar1.setOption(option);
				})();
			},
			
			error: function(){
				alert("异常");
			},
		})
		
		function addDate(date,days){ 
		       var d=new Date(date); 
		       d.setDate(d.getDate()+days); 
		       var m=d.getMonth()+1; 
		       var day=d.getDate();
		       if(m.length==1){
		    	   m="0"+m;
		       }
		       if(day.length==1){
		    	   day="0"+day;
		       }
		       return d.getFullYear()+'-'+m+'-'+d.getDate(); 
		     } 
	}
	</script>


</body>
</html>
